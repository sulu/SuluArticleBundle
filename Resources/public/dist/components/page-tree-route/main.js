define(["text!./skeleton.html"],function(a){"use strict";var b={options:{historyApi:null,historyResultKey:"routes",historyPathKey:"path"},templates:{skeleton:a},translations:{showHistory:"public.show-history"}},c=function(a){return a.replace(/\/+$/g,"")},d=function(a,b){return c(a)+"/"+b};return{defaults:b,initialize:function(){this.$el.closest(".form-group").find("label").addClass("required"),this.bindCustomEvents(),this.render();var a=this.getData(),b=a.page||{};this.$prefix.val(b.path||""),this.$suffix.val(a.suffix||"")},bindCustomEvents:function(){},render:function(){this.html(this.templates.skeleton({translations:this.translations,options:this.options})),this.$prefix=this.$el.find(".prefix"),this.$suffix=this.$el.find(".suffix"),this.$choose=this.$el.find(".choose"),this.bindDomEvents()},bindDomEvents:function(){this.$suffix.on("change",function(a){this.setSuffix($(a.currentTarget).val())}.bind(this)),this.$choose.on("click",function(){return this.pageSelectClicked(),!1}.bind(this))},pageSelectClicked:function(){var a=$("<div/>"),b=this.getData();this.$el.append(a),this.sandbox.start([{name:"page-tree-route/page-select@suluarticle",options:{el:a,selected:(b.page||{}).uuid||null,locale:this.options.locale,selectCallback:this.setParentPage.bind(this)}}])},setParentPage:function(a){var b=this.getData();b.page={uuid:a.id,path:a.url||"/"},b.path=null,b.suffix&&b.suffix.length>0&&(b.path=d(b.page.path,b.suffix)),this.setData(b),this.$prefix.val("/"===b.page.path?b.page.path:c(b.page.path)).trigger("change")},setSuffix:function(a){var b=this.getData();b.suffix=a,b.path=null,b.page&&(b.path=d(b.page.path,b.suffix)),this.setData(b)},setData:function(a){this.$el.data("value",a)},getData:function(){return this.$el.data("value")||{}}}});