define(["underscore","config"],function(a,b){"use strict";var c={options:{locale:null,url:"",resultKey:null,searchFields:[],matchings:[],instanceName:"teaser-selection",selectCallback:function(a){}},templates:{skeleton:['<div class="teaser-selection-tabs"></div>','<div class="grid">','   <div class="grid-row search-row">','       <div class="grid-col-8"/>','       <div class="grid-col-4 teaser-selection-search"/>',"   </div>",'   <div class="grid-row">','       <div class="grid-col-12 teaser-selection-list"/>',"   </div>","</div>"].join("")}},d=b.get("sulu_article"),e=function(){if(1===d.typeNames.length)return[];var b=[];return d.displayTabAll===!0&&b.push({id:"all",name:"public.all"}),a.each(d.typeNames,function(a){b.push({id:a,name:d.types[a].title})}.bind(this)),b};return{defaults:c,initialize:function(){this.$el.parent().removeClass("content-spacing"),this.$el.parent().addClass("article-teaser-selection");var b=$(this.templates.skeleton());this.$el.append(b),this.sandbox.start([{name:"search@husky",options:{el:".teaser-selection-search",appearance:"white small",instanceName:this.options.instanceName+"-teaser-search"}},{name:"datagrid@husky",options:{el:".teaser-selection-list",instanceName:this.options.instanceName,url:this.getUrl(),preselected:a.map(this.options.data,function(a){return a.id}),resultKey:this.options.resultKey,sortable:!1,columnOptionsInstanceName:"",clickCallback:function(a){this.sandbox.emit("husky.datagrid."+this.options.instanceName+".toggle.item",a)}.bind(this),selectedCounter:!0,searchInstanceName:this.options.instanceName+"-teaser-search",searchFields:this.options.searchFields,paginationOptions:{dropdown:{limit:20}},matchings:this.options.matchings}},{name:"tabs@husky",options:{el:".teaser-selection-tabs",data:e(),callback:this.changeType.bind(this)}}]),this.bindCustomEvents()},bindCustomEvents:function(){this.sandbox.on("husky.datagrid."+this.options.instanceName+".item.select",function(a){this.options.selectCallback({type:this.options.type,id:a})}.bind(this)),this.sandbox.on("husky.datagrid."+this.options.instanceName+".item.deselect",function(a){this.options.deselectCallback({type:this.options.type,id:a})}.bind(this))},getUrl:function(){return this.options.url.replace("{locale}",this.options.locale)},changeType:function(a){var b=a.id;"all"===a.id&&(b=null),this.sandbox.emit("husky.datagrid."+this.options.instanceName+".url.update",{type:b})}}});